{"version":3,"sources":["../../app-src/controllers/NegociacaoController.js"],"names":["Negociacoes","NegociacoesView","Mensagem","MensagemView","NegociacaoService","getNegociacaoDao","Negociacao","Bind","DateConverter","NegociacaoController","constructor","$","document","querySelector","bind","Object","assign","_inputData","_inputQuantidade","_inputValor","_service","_negociacoes","_mensagem","_init","adiciona","event","preventDefault","negociacao","_criarNegociacao","then","dao","texto","_limpaFormulario","catch","err","console","log","message","importa","obterNegociacoesDoPeriodo","periodo","filter","novaNegociacao","getArray","some","negociacaoExistente","equals","map","x","apaga","apagaTodos","esvazia","listaTodos","negociacoes","value","focus","Date","paraData","parseInt","parseFloat"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { Negociacoes } from '../domain/negociacao/Negociacoes.js';\nimport { NegociacoesView } from '../ui/views/NegociacoesView.js';\nimport { Mensagem } from '../ui/models/Mensagem.js';\nimport { MensagemView } from '../ui/views/MensagemView.js';\nimport { NegociacaoService } from '../domain/negociacao/NegociacaoService.js';\nimport { getNegociacaoDao } from '../util/DaoFactory.js';\nimport { Negociacao } from '../domain/negociacao/Negociacao.js';\nimport { Bind } from '../util/Bind.js';\nimport { DateConverter } from '../ui/converters/DateConverter.js';\n\nexport class NegociacaoController {\n    constructor() {\n        let $ = document.querySelector.bind(document);\n        Object.assign(this, {\n            _inputData: $('#data'),\n            _inputQuantidade: $('#quantidade'),\n            _inputValor: $('#valor'),\n            _service: new NegociacaoService(),\n            _negociacoes: new Bind(\n                new Negociacoes(),\n                new NegociacoesView('#negociacoes'),\n                'adiciona', 'esvazia'\n            ),\n            _mensagem: new Bind(\n                new Mensagem(),\n                new MensagemView('#mensagemView'),\n                'texto'\n            )\n        });\n        this._init();\n    }\n    adiciona(event) {\n        try {\n            event.preventDefault();\n            const negociacao = this._criarNegociacao();\n            getNegociacaoDao()\n            .then(dao => dao.adiciona(negociacao))\n            .then(() => {\n                this._negociacoes.adiciona(this._criarNegociacao());\n                this._mensagem.texto = 'Negociação adicionada com sucesso';\n                this._limpaFormulario();\n            }).catch(err => this._mensagem.texto = err);\n        } catch(err) {\n            console.log(err);\n            this._mensagem.texto = err.message;\n        }\n    }\n    importa() {\n        this._service\n        .obterNegociacoesDoPeriodo()\n        .then(\n            periodo => {\n                periodo.filter(novaNegociacao =>\n                    !this._negociacoes.getArray()\n                    .some(negociacaoExistente =>\n                        novaNegociacao.equals(negociacaoExistente)\n                    )\n                )\n                .map( x => this._negociacoes.adiciona(x))\n                this._mensagem.texto = \"Negociações do período importadas com sucesso!\"\n            }\n        ).catch( err => this._mensagem.texto = err);\n    }\n    apaga() {\n        getNegociacaoDao()\n        .then(dao => dao.apagaTodos())\n        .then(() => {\n            this._negociacoes.esvazia();\n            this._mensagem.texto = 'Negociações apagadas com sucesso';\n        })\n        .catch(err => this._mensagem.texto = err);\n    }\n    _init() {\n        getNegociacaoDao()\n        .then(dao => dao.listaTodos())\n        .then(negociacoes => negociacoes.map( x => this._negociacoes.adiciona(x)))\n        .catch(err => this._mensagem.texto = err)\n    }\n    _limpaFormulario() {\n        this._inputData.value = '',\n        this._inputQuantidade.value = 1,\n        this._inputValor.value = '0.00',\n        this._inputData.focus()\n    }\n    _criarNegociacao() {\n        return new Negociacao(\n            new Date(DateConverter.paraData(this._inputData.value)),\n            parseInt(this._inputQuantidade.value),\n            parseFloat(this._inputValor.value)\n        );\n    }\n}\n"]}